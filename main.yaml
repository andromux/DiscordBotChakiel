name: ğŸš€ Build Windows Executable (PyInstaller)

on:
  push:
    branches: [ main ]
  # Esto permite ejecutar el flujo de trabajo manualmente desde la pestaÃ±a 'Actions'
  workflow_dispatch: 

jobs:
  build:
    # Usaremos el runner de Ubuntu para compilar el .exe
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ”„ Checkout code
      uses: actions/checkout@v4

    # --- Pre-CompilaciÃ³n: Generar el .spec file localmente ---
    # La acciÃ³n requiere que el archivo principal estÃ© en la raÃ­z del 'path'
    - name: ğŸ“ Rename main script (Temporal)
      run: mv src/BotGUI.py src/main.py

    # --- InstalaciÃ³n y CompilaciÃ³n con PyInstaller ---
    - name: ğŸ“¦ Package Application with PyInstaller for Windows
      uses: JackMcKew/pyinstaller-action-windows@main
      with:
        # La ruta al directorio que contiene el script y requirements.txt
        path: src
        # Opciones de PyInstaller: 
        # --onefile (un solo ejecutable), 
        # --windowed (sin consola, Â¡necesario para Tkinter!)
        pyinstaller_options: --onefile --windowed

    # --- Post-CompilaciÃ³n: Cargar el ejecutable como Artifact ---
    - name: ğŸ“¤ Upload Windows Executable Artifact
      uses: actions/upload-artifact@v4
      with:
        name: Discord-Cleaner-Bot-GUI-Windows-Executable
        # La acciÃ³n de PyInstaller pone el .exe dentro de src/dist/windows
        path: src/dist/windows/*
        retention-days: 30

    # --- Cleanup (Opcional) ---
    - name: ğŸ—‘ï¸ Cleanup temporary file
      run: mv src/main.py src/BotGUI.py
