name: ðŸš€ Build Windows Executable (PyInstaller)

on:
  push:
    branches: [ main ]
  workflow_dispatch: 

jobs:
  build:
    runs-on: windows-latest 

    steps:
    - name: ðŸ”„ Checkout code
      uses: actions/checkout@v4

    # --- Este paso genera el EXE y el SPEC ---
    - name: ðŸ“¦ Package Application with PyInstaller
      uses: sayyid5416/pyinstaller@v1
      with:
        # El archivo de entrada es src/main.py
        spec: 'src/main.py' 
        requirements: 'src/requirements.txt'
        options: --onefile, --windowed
        python_ver: '3.10'
        
        # El nombre del .zip que aparecerÃ¡ en la pestaÃ±a Artifacts.
        # ESTE ES EL PASO QUE SUBE EL EJECUTABLE.
        upload_exe_with_name: 'Discord-Cleaner-Bot-GUI' 

    # --- CorrecciÃ³n 1: El archivo generado se llama main.spec ---
    - name: ðŸ“¤ Upload Generated .spec file (Opcional)
      uses: actions/upload-artifact@v4
      with:
        name: PyInstaller-Spec-File
        # RUTA CORREGIDA: Ahora busca 'main.spec'
        path: ./main.spec 
        retention-days: 7
